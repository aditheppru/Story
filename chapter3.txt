done chapter3
this is from clean-plot branch
